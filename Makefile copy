NAME = MlibX

HEADER = mlx_test.h \
         mlx/mlx.h

ALL_SRC = mlx_test.c

OBJS = ${ALL_SRC:.c=.o}

CFLAGS = -Wall -Wextra -Werror

CC = gcc

UNAME = $(shell uname)
ifeq ($(UNAME), Linux)
    INCLUDES = -I/usr/include -Imlx
    MLX_FLAGS = -Lmlx -lmlx -L/usr/lib/X11 -lXext -lX11
else
    INCLUDES = -I/opt/X11/include -Imlx
    MLX_FLAGS = -Lmlx -lmlx -L/usr/X11/lib -lXext -lX11 -framework OpenGL -framework AppKit
endif

MLX_DIR = ./mlx
MLX_LIB = libmlx.a

all: $(MLX_LIB) $(NAME)

%.o: %.c $(HEADER)
	$(CC) $(CFLAGS) $(INCLUDES) -c $< -o $@

$(NAME): $(OBJS)
	$(CC) $(CFLAGS) -o $(NAME) $(OBJS) $(MLX_FLAGS)

$(MLX_LIB):
	@make -C $(MLX_DIR)

re: fclean all

clean:
	${RM} ${OBJS}

fclean: clean
	${RM} ${NAME}

.PHONY: all clean fclean re
